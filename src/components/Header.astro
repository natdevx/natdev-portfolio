---
import ThemeToggle from "./ThemeToggle.astro";
---

<header class="fixed top-0 left-0 w-full z-50 transition-all duration-300 bg-transparent">
  <div
    class="max-w-3xl mx-auto mt-4 flex items-center justify-between px-4 py-2 rounded-full
           bg-[var(--color-surface)]/60 backdrop-blur-md border border-[var(--color-border)]/40
           shadow-[0_4px_30px_rgba(0,0,0,0.1)] transition-all duration-300" >
    <!-- Logo -->
    <a href="/" class="flex items-center gap-2">
      <span
        class="text-xl font-heading font-bold text-[var(--color-heading)] tracking-tight">
        Nat
        <span class="text-[var(--color-primary)]">Dev.</span>
      </span>
    </a>

    <!-- Navegación Desktop -->
    <nav
      class="hidden md:flex items-center gap-6 text-md font-medium tracking-wide"
      aria-label="Main navigation">
      <a
        href="#projects"
        class="hover:text-[var(--color-primary)] text-[var(--color-text)] transition-colors">
        Inicio
      </a>
      <a
        href="#about"
        class="hover:text-[var(--color-primary)] text-[var(--color-text)] transition-colors">
        Acerca de mí
      </a>
      
      <a
        href="#testimonials"
        class="hover:text-[var(--color-primary)] text-[var(--color-text)] transition-colors"
      >
        Proyectos
      </a>
      <a
        href="#contact"
        class="hover:text-[var(--color-primary)] text-[var(--color-text)] transition-colors">
        Contacto
      </a>
    </nav>

    <!-- Botones (Dark Mode + Mobile) -->
    <div class="flex items-center gap-3">
      <ThemeToggle />

      <button
        id="mobile-toggle"
        class="md:hidden p-2 rounded-md bg-[var(--color-surface)]/50 hover:bg-[var(--color-surface)]/80 
               text-[var(--color-text)] focus:outline-none focus:ring-2 focus:ring-[var(--color-primary)]"
        aria-label="Abrir menú móvil"
        aria-expanded="false">
        <svg
          class="w-6 h-6"
          viewBox="0 0 24 24"
          fill="none"
          stroke="currentColor"
          aria-hidden="true" >
          <path
            stroke-linecap="round"
            stroke-linejoin="round"
            stroke-width="1.7"
            d="M4 6h16M4 12h16M4 18h16"/>
        </svg>
      </button>
    </div>
  </div>

  <!-- Menú móvil -->
  <div id="mobile-menu"
    class="hidden md:hidden bg-[var(--color-surface)]/80 backdrop-blur-md mt-2 mx-4 rounded-xl border 
    border-[var(--color-border)]/30 shadow-lg">

    <div class="px-6 py-4 flex flex-col gap-3 text-sm font-medium">
      <a href="#testimonials" class="hover:text-[var(--color-primary)]">Inicio</a>
      <a href="#about" class="hover:text-[var(--color-primary)]">Acerca de mí</a>
      <a href="#projects" class="hover:text-[var(--color-primary)]">Proyectos</a>
      <a href="#contact" class="hover:text-[var(--color-primary)]">Contacto</a>
    </div>
    
  </div>

  <script>
    document.addEventListener("DOMContentLoaded", () => {
      const header = document.querySelector("header");
      const navLinks = document.querySelectorAll("nav a");
      const sections = document.querySelectorAll("section[id]");

      // Detectar sección activa
      const setActiveLink = () => {
        let current = "";
        sections.forEach((section) => {
          const sectionTop = section.offsetTop - 100;
          if (scrollY >= sectionTop) current = section.getAttribute("id");
        });

        navLinks.forEach((link) => {
          link.classList.remove("text-[var(--color-primary)]", "font-semibold");
          if (link.getAttribute("href") === "#" + current) {
            link.classList.add("text-[var(--color-primary)]", "font-semibold");
          }
        });
      };

      window.addEventListener("scroll", setActiveLink);

      // Scroll suave
      navLinks.forEach((link) => {
        link.addEventListener("click", (e) => {
          e.preventDefault();
          const target = document.querySelector(link.getAttribute("href"));
          if (target) {
            window.scrollTo({
              top: target.offsetTop - 80,
              behavior: "smooth",
            });
          }
        });
      });
    });
  </script>
</header>
